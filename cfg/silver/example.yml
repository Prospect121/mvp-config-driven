layer: silver
dry_run: true
environment: development
platform:
  name: local
  compute:
    engine: spark
storage:
  dataset_config: config/datasets/examples/toy_customers.yml
  environment_config: config/env.yml
  database_config: config/database.yml
  source:
    dataset_config: config/datasets/examples/toy_customers.yml
  sink:
    type: delta
    options:
      path: s3://example-silver/tables/customers/
transformations:
  steps:
    - name: sanitize_phone_numbers
      params:
        country: CO
    - name: compute_churn_flags
      params:
        window_days: 30
quality:
  expectations:
    require_not_null:
      - customer_id
      - signup_ts
lineage:
  dataset: examples.toy_customers.silver
