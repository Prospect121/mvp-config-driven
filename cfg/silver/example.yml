layer: silver
dry_run: true
environment: development
paths:
  dataset: config/datasets/examples/toy_customers.yml
  environment: config/env.yml
  database: config/database.yml
compute:
  engine: spark
  options:
    spark.sql.session.timeZone: UTC
io:
  source:
    dataset_config: config/datasets/examples/toy_customers.yml
  sink:
    format: delta
    options:
      path: s3://example-silver/tables/customers/
transform:
  steps:
    - name: normalize_columns
      params:
        mappings:
          CUSTOMER_ID: customer_id
          SEGMENT: segment
          STATUS: status
          SIGNUP_TS: signup_ts
  sql:
    - SELECT * FROM __THIS__
