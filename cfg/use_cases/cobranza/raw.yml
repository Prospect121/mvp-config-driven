layer: raw
extends: "../../finance/raw/transactions_jdbc.yml"
io:
  source:
    query: |
      SELECT *
      FROM transactions
      WHERE updated_at >= '${RAW_WM_TS}' AND portfolio = 'collections'
transform:
  sql:
    - |
      SELECT *
      FROM __BASE__
      WHERE status IN ('overdue','delinquent')
dq:
  expectations:
    - type: condition
      expr: "amount >= 0"
