layer: silver
extends: "../../finance/silver/transactions.yml"
transform:
  sql: |
    SELECT
      account_id,
      posted_date,
      amount,
      CASE
        WHEN days_between(now(), posted_date) <= 30 THEN '0-30'
        WHEN days_between(now(), posted_date) <= 60 THEN '31-60'
        WHEN days_between(now(), posted_date) <= 90 THEN '61-90'
        ELSE '90+'
      END AS bucket
    FROM __BASE__
