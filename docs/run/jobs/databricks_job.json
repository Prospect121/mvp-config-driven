{
  "name": "prodi-layered-pipeline",
  "job_clusters": [
    {
      "job_cluster_key": "shared_cluster",
      "new_cluster": {
        "spark_version": "13.3.x-scala2.12",
        "num_workers": 2,
        "node_type_id": "Standard_DS3_v2"
      }
    }
  ],
  "tasks": [
    {
      "task_key": "raw",
      "description": "Ingesta inicial",
      "job_cluster_key": "shared_cluster",
      "libraries": [
        { "whl": "dbfs:/libs/prodi-1.4.0.whl" }
      ],
      "wheel_task": {
        "package_name": "prodi",
        "entry_point": "run-layer",
        "parameters": [
          "--layer", "raw",
          "--config", "dbfs:/cfg/run/raw.yml",
          "--env", "prod"
        ]
      }
    },
    {
      "task_key": "bronze",
      "depends_on": [{ "task_key": "raw" }],
      "job_cluster_key": "shared_cluster",
      "libraries": [
        { "whl": "dbfs:/libs/prodi-1.4.0.whl" }
      ],
      "wheel_task": {
        "package_name": "prodi",
        "entry_point": "run-layer",
        "parameters": [
          "--layer", "bronze",
          "--config", "dbfs:/cfg/run/bronze.yml",
          "--env", "prod"
        ]
      }
    },
    {
      "task_key": "silver",
      "depends_on": [{ "task_key": "bronze" }],
      "job_cluster_key": "shared_cluster",
      "libraries": [
        { "whl": "dbfs:/libs/prodi-1.4.0.whl" }
      ],
      "wheel_task": {
        "package_name": "prodi",
        "entry_point": "run-layer",
        "parameters": [
          "--layer", "silver",
          "--config", "dbfs:/cfg/run/silver.yml",
          "--env", "prod"
        ]
      }
    },
    {
      "task_key": "gold",
      "depends_on": [{ "task_key": "silver" }],
      "job_cluster_key": "shared_cluster",
      "libraries": [
        { "whl": "dbfs:/libs/prodi-1.4.0.whl" }
      ],
      "wheel_task": {
        "package_name": "prodi",
        "entry_point": "run-layer",
        "parameters": [
          "--layer", "gold",
          "--config", "dbfs:/cfg/run/gold.yml",
          "--env", "prod"
        ]
      }
    }
  ],
  "format": "MULTI_TASK"
}
